<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>expirationd API reference</title>
    <link rel="stylesheet" href="ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">





<!-- Menu -->

<div id="navigation">
<br/>
<h1>expirationd</h1>


<h2>Contents</h2>
<ul>
<li><a href="#Task_instance_methods">Task instance methods </a></li>
<li><a href="#Module_constants">Module constants </a></li>
<li><a href="#Module_functions">Module functions </a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><strong>expirationd</strong></li>
</ul>

</div>

<div id="content">

<h1>Module <code>expirationd</code></h1>
<p>expirationd - data expiration with custom quirks.</p>
<p><table class="markdown_table">
</table>
</p>


<h2><a href="#Task_instance_methods">Task instance methods </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#task.start">task.start (self)</a></td>
	<td class="summary">Start a task.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#task.stop">task.stop (self)</a></td>
	<td class="summary">Stop a task.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#task.restart">task.restart (self)</a></td>
	<td class="summary">Restart a task.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#task.kill">task.kill (self)</a></td>
	<td class="summary">Kill a task.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#task.statistics">task.statistics (self)</a></td>
	<td class="summary">Get a statistics about a task.</td>
	</tr>
</table>
<h2><a href="#Module_constants">Module constants </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#_VERSION">_VERSION</a></td>
	<td class="summary">Current module version in format <code>MAJOR.MINOR.PATCH</code>.</td>
	</tr>
</table>
<h2><a href="#Module_functions">Module functions </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#cfg">cfg (options)</a></td>
	<td class="summary">Configure expirationd.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#start">start (name, space, is_tuple_expired[, options])</a></td>
	<td class="summary">Run a scheduled task to check and process (expire) tuples in a given space.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#kill">kill (name)</a></td>
	<td class="summary">Kill an existing task.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#tasks">tasks ()</a></td>
	<td class="summary">Return a list with task's names.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#stats">stats ([name])</a></td>
	<td class="summary">Return task statistics in table.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#task">task (name)</a></td>
	<td class="summary">Get task by name.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#update">update ()</a></td>
	<td class="summary">Reload module.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header has-description"><a name="Task_instance_methods"></a>Task instance methods </h2>

          <div class="section-description">

<p> NOTE: task object contains a number of properties that available for users.
 However these properties are not a part of expirationd API. Property name
 can be changed or property itself can be removed in future version. Be
 careful!

          </div>
    <dl class="function Methods">
    <dt>
    <a name="task.start"></a>
    <strong>task.start (self)</strong>
    </dt>
    <dd>
    <p>Start a task.  It continues processing from a last tuple if the task
  was previously stopped by <a href="index.html#task.stop">task.stop</a> and the task has default
  <code>start_key</code> and <code>iterate_with</code> functions.
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
        <br>
        <span class="parameter-description">
        <p>
     Task instance.
</p>
        </span>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        None
    </ol>




</dd>
    <dt>
    <a name="task.stop"></a>
    <strong>task.stop (self)</strong>
    </dt>
    <dd>
    <p>Stop a task. <table class="markdown_table">
</table>
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
        <br>
        <span class="parameter-description">
        <p>
     Task instance.
</p>
        </span>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        None
    </ol>




</dd>
    <dt>
    <a name="task.restart"></a>
    <strong>task.restart (self)</strong>
    </dt>
    <dd>
    <p>Restart a task. <table class="markdown_table">
</table>
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
        <br>
        <span class="parameter-description">
        <p>
     Task instance.
</p>
        </span>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        None
    </ol>




</dd>
    <dt>
    <a name="task.kill"></a>
    <strong>task.kill (self)</strong>
    </dt>
    <dd>
    <p>Kill a task. <table class="markdown_table">
</table>
<p>
 Stop a task and delete it from list of tasks.
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
        <br>
        <span class="parameter-description">
        <p>
     Task instance.
</p>
        </span>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        None
    </ol>




</dd>
    <dt>
    <a name="task.statistics"></a>
    <strong>task.statistics (self)</strong>
    </dt>
    <dd>
    <p>Get a statistics about a task. <table class="markdown_table">
</table>
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
        <br>
        <span class="parameter-description">
        <p>
     Task instance.
</p>
        </span>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

         Response of the following structure:
<p><pre> {
     checked_count = number,
     expired_count = number,
     restarts = number,
     working_time = number,
 }</pre>
<p>
 where:
<p> <code>checked_count</code> is a number of tuples checked for expiration (expired + skipped).
<p> <code>expired_count</code> is a number of expired tuples.
<p> <code>restarts</code> is a number of restarts since start. From the start <code>restarts</code> is equal to 1.
<p> <code>working_time</code> is a task's operation time.

    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Module_constants"></a>Module constants </h2>

    <dl class="function Constants">
    <dt>
    <a name="_VERSION"></a>
    <strong>_VERSION</strong>
    </dt>
    <dd>
    <p>Current module version in format <code>MAJOR.MINOR.PATCH</code>. <table class="markdown_table">
</table>
</p>







</dd>
</dl>
    <h2 class="section-header "><a name="Module_functions"></a>Module functions </h2>

    <dl class="function Functions">
    <dt>
    <a name="cfg"></a>
    <strong>cfg (options)</strong>
    </dt>
    <dd>
    <p>Configure expirationd. <table class="markdown_table">
</table>
<p>
 Since version 1.2.0.
<p> How to set up a configuration option:
<p><pre> expirationd.cfg({metrics = true})</pre>
<p>
 How to get an option value:
<p><pre> print(expirationd.cfg.metrics)
 true</pre>
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">options</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">table</span></span>)
            </span>

        <br>
        <span class="parameter-description">
        <p><table class="markdown_table">
</table>
</p>
        </span>
        <ul>
        <li><span class="parameter">metrics</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">bool</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Enable or disable stats collection by <a href="https://github.com/tarantool/metrics/">metrics</a>. metrics >= 0.11.0
     is required. It is enabled by default.
<p>     If enabled it creates four counter collectors, see <a href="index.html#task.statistics">task.statistics</a>:
<p>     1. <code>expirationd_checked_count</code>
<p>     2. <code>expirationd_expired_count</code>
<p>     3. <code>expirationd_restarts</code>
<p>     4. <code>expirationd_working_time</code>
<p>     Labeled with <code>name = task_name</code>.
<p><table class="markdown_table">
</table>
</p>
        </span>
        </li>
        </li></ul>
    </ul>

    <h3>Returns:</h3>
    <ol>

        None
    </ol>




</dd>
    <dt>
    <a name="start"></a>
    <strong>start (name, space, is_tuple_expired[, options])</strong>
    </dt>
    <dd>
    <p>Run a scheduled task to check and process (expire) tuples in a given space. <table class="markdown_table">
</table>
<p>
 How expirationd works in general:
<p> 1. Process min(<code>space_length</code>, <code>tuples_per_iteration</code>) tuples at once.
<p> 2. Sleep <code>tuples_per_iteration</code> × <code>full_scan_time</code> / <code>space_length</code> (but not
    beyond 1 second).
<p> 3. Repeat 1-2 until the whole space will be traversed.
<p> 4. Sleep 1 second.
<p> 5. Repeat 1-4.
<p> NOTE: By default expirationd does not start tasks on an read-only instance
 for non-local persistent spaces, see the <code>force</code> option.
<p> NOTE: By default expirationd continues processing from a last processed
 tuple if a task with same name has not been killed properly with
 <a href="index.html#task.kill">task.kill</a> or <a href="index.html#kill">kill</a>. This behavior only works with default functions
 <code>start_key</code> and <code>iterate_with</code>. You need to set at least one function if
 another behavior is needed, see <code>start_key</code> and <code>iterate_with</code> options.
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">name</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">string</span></span>)
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Task name.</p>
        </span>
        </li>
        <li><span class="parameter">space</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">string</span></span>)
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Space to look in for expired tuples. <code>space</code> can be numeric or
     string. It can be a space id or a space name, respectively.</p>
        </span>
        </li>
        <li><span class="parameter">is_tuple_expired</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">func</span></span>)
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Function, must accept tuple and return <code>true</code> or <code>false</code> (is tuple
     expired or not), receives <code>args</code> and <code>tuple</code> as arguments.
<p>
 Example of function:
<p><pre> local function is_tuple_expired(args, tuple)
     local tuple_expire_time = get_field(tuple, args.field_no)
     local current_time = fiber.time()
     return current_time >= tuple_expire_time
 end</pre>
</p>
        </span>
        </li>
        <li><span class="parameter">options</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">table</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>

        <br>
        <span class="parameter-description">
        <p>
     Table with named options.</p>
        </span>
        <ul>
        <li><span class="parameter">args</span>
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
        <br>
        <span class="parameter-description">
        <p>
     Passed to <code>is_tuple_expired()</code> and <code>process_expired_tuple()</code> as
     an additional context.</p>
        </span>
        </li>
        <li><span class="parameter">atomic_iteration</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">boolean</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     False (default) to process each tuple as a single transaction and true
     to process tuples from each batch in a single transaction.</p>
        </span>
        </li>
        <li><span class="parameter">force</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">boolean</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     By default expirationd processes tasks for all types of spaces only on
     an writable instance. It does not process tasks on an read-only instance
     for <a href="https://www.tarantool.io/en/doc/latest/reference/configuration/#confval-read_only">non-local persistent spaces</a>. It means that expirationd will not
     start the task processing on a replica for regular spaces. Set the
     option to <code>true</code> to force enable the task processing anyway.
<p><table class="markdown_table">
</table>
</p>
        </span>
        </li>
        <li><span class="parameter">force_allow_functional_index</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">boolean</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     By default expirationd returns an error on iteration through a functional
     index for Tarantool < 2.8.4 because it may cause a crash, see
     https://github.com/tarantool/expirationd/issues/101
     You can skip the error using the option if you know what you are doing
     (implement your own <code>iterate_with</code> as example).</p>
        </span>
        </li>
        <li><span class="parameter">full_scan_delay</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">number</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Sleep time between full scans (in seconds). It is allowed to pass an FFI
     number: <code>1LL</code>, <code>1ULL</code> etc. Default value is 1 sec.</p>
        </span>
        </li>
        <li><span class="parameter">full_scan_time</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">number</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Time required for a full index scan (in seconds). It is allowed to pass
     an FFI number: <code>1LL</code>, <code>1ULL</code> etc. <code>full_scan_time</code> used for calculation
     of time during which fiber sleeps between iterations. Default value is
     3600.</p>
        </span>
        </li>
        <li><span class="parameter">index</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">string</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Name or id of the index to iterate on. If omitted, will use the primary
     index. If there's no index with this name, will throw an error.
     Supported index types are TREE and HASH, using other types will result
     in an error.</p>
        </span>
        </li>
        <li><span class="parameter">iterate_with</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">func</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Function which returns an iterator object which provides tuples to
     check, considering the <code>start_key</code>, <code>process_while</code> and other options.
     When option is nil default function is used. Function must accept a task
     instance object. Default function returns iterator returned by
     <a href="https://www.tarantool.io/en/doc/latest/reference/reference_lua/box_index/pairs/.">index_object:pairs()</a>, where <code>index</code> is a primary index or index
     that specified with argument <code>options.index</code>:
<p> Example of function:
<p><pre>  local function iterate_with()
      index:pairs(option.start_key(), {
         iterator = option.iterator_type
      }):take_while(
             function()
                 return option.process_while()
             end
        )
  end</pre>
<p><table class="markdown_table">
</table>
</p>
        </span>
        </li>
        <li><span class="parameter">iteration_delay</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">number</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Max sleep time between iterations (in seconds). It is allowed to pass
     an FFI number: <code>1LL</code>, <code>1ULL</code> etc. Default value is 1 sec.
     Fiber sleeps min(<code>tuples_per_iteration</code> × <code>full_scan_time</code> / <code>space_length</code>, <code>iteration_delay</code>).</p>
        </span>
        </li>
        <li><span class="parameter">iterator_type</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">string</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Type of the iterator to use, as string or box.index constant, for
     example, <code>EQ</code> or <code>box.index.EQ</code>, default is <code>box.index.ALL</code>. See more
     about index iterators in <a href="https://www.tarantool.io/en/doc/latest/reference/reference_lua/box_index/pairs/.">index_object:pairs()</a>.
<p><table class="markdown_table">
</table>
</p>
        </span>
        </li>
        <li><span class="parameter">on_full_scan_complete</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">func</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Function to call after completing a full scan iteration. Default value
     is a function that do nothing.</p>
        </span>
        </li>
        <li><span class="parameter">on_full_scan_error</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">func</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Function to call after terminating a full scan due to an error. Default
     value is a function that do nothing.
<p> Example of function:
<p><pre> local function on_full_scan_error()
     pcall(fiber.sleep, 1)
 end</pre>
</p>
        </span>
        </li>
        <li><span class="parameter">on_full_scan_start</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">func</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Function to call before starting a full scan iteration. Default value
     is a function that do nothing.</p>
        </span>
        </li>
        <li><span class="parameter">on_full_scan_success</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">func</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Function to call after successfully completing a full scan iteration.
     Default value is a function that do nothing.</p>
        </span>
        </li>
        <li><span class="parameter">process_expired_tuple</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">func</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Applied to expired tuples, receives <code>space</code>, <code>args</code>, <code>tuple</code> as
     arguments. When <code>process_expired_tuple</code> is not passed (or <code>nil</code> passed),
     tuples are removed.
<p> Example of function:
<p><pre> local function put_tuple_to_archive(space, args, tuple)
     box.space[space]:delete{tuple[1]}
     local email = tuple[2]
     if args.archive_space ~= nil and email ~= nil then
         box.space[args.archive_space]:replace{email, fiber.time()}
     end
 end</pre>
</p>
        </span>
        </li>
        <li><span class="parameter">process_while</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">func</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Function to call before checking each tuple. If it returns false, the
     task will stop until next full scan. Default is a function that always
     return <code>true</code>.
<p> Example of function:
<p><pre> local function process_while()
     return false
 end</pre>
</p>
        </span>
        </li>
        <li><span class="parameter">start_key</span>
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
        <br>
        <span class="parameter-description">
        <p>
     Start iterating from the tuple with this index value. Or when iterator
     is 'EQ', iterate over tuples with this index value. Must be a value of
     the same data type as the index field or fields, or a function which
     returns such value. If omitted or nil, all tuples will be checked.</p>
        </span>
        </li>
        <li><span class="parameter">tuples_per_iteration</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">number</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Number of tuples to check in one batch (iteration). It is allowed to
     pass an FFI number: <code>1LL</code>, <code>1ULL</code> etc. Default value is 1024.</p>
        </span>
        </li>
        <li><span class="parameter">vinyl_assumed_space_len_factor</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">number</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Factor for recalculation of vinyl space size. Vinyl space size can't be
     counted (since many operations, <code>upsert</code> for example, are applied when
     you address some data), so you should count (approximate space size)
     tuples with the first start. <code>vinyl_assumed_space_len</code> is approximate
     count for first run and <code>vinyl_assumed_space_len_factor</code> for next
     milestone (after we've reached next milestone is <code>*</code> and so on). It is
     allowed to pass an FFI number: <code>1LL</code>, <code>1ULL</code> etc. Default value is 2.</p>
        </span>
        </li>
        <li><span class="parameter">vinyl_assumed_space_len</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">number</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Assumed size of vinyl space (in the first iteration).
     Vinyl space size can't be counted (since many operations, <code>upsert</code> for
     example, are applied when you address some data), so you should count
     (approximate space size) tuples with the first start.
     <code>vinyl_assumed_space_len</code> is approximate count for first run and
     <code>vinyl_assumed_space_len_factor</code> for next milestone (after we've reached
     next milestone is <code>*</code> and so on). It is allowed to pass an FFI number:
     <code>1LL</code>, <code>1ULL</code> etc. Default value is 10^7.
</p>
        </span>
        </li>
        </li></ul>
    </ul>

    <h3>Returns:</h3>
    <ol>

        task instance
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> expirationd = <span class="global">require</span>(<span class="string">'expirationd'</span>)

box.cfg{}

<span class="keyword">local</span> space = box.space.old
<span class="keyword">local</span> job_name = <span class="string">"clean_all"</span>

<span class="keyword">local</span> <span class="keyword">function</span> is_expired(args, tuple)
    <span class="keyword">return</span> <span class="keyword">true</span>
<span class="keyword">end</span>

<span class="keyword">local</span> <span class="keyword">function</span> delete_tuple(space, args, tuple)
    box.space[space]:delete{tuple[<span class="number">1</span>]}
<span class="keyword">end</span>

expirationd.start(job_name, space.id, is_expired, {
    process_expired_tuple = delete_tuple,
    args = <span class="keyword">nil</span>,
    tuples_per_iteration = <span class="number">50</span>,
    full_scan_time = <span class="number">3600</span>
})</pre>
    </ul>

</dd>
    <dt>
    <a name="kill"></a>
    <strong>kill (name)</strong>
    </dt>
    <dd>
    <p>Kill an existing task. <table class="markdown_table">
</table>
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">name</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">string</span></span>)
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Task name.
</p>
        </span>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        None
    </ol>




</dd>
    <dt>
    <a name="tasks"></a>
    <strong>tasks ()</strong>
    </dt>
    <dd>
    <p>Return a list with task's names. <table class="markdown_table">
</table>
</p>



    <h3>Returns:</h3>
    <ol>

         Response of the following structure:
<p><pre> {
     "expirationd-1"
     "expirationd-2",
     "expirationd-3",
 }</pre>

    </ol>




</dd>
    <dt>
    <a name="stats"></a>
    <strong>stats ([name])</strong>
    </dt>
    <dd>
    <p>Return task statistics in table. <table class="markdown_table">
</table>
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">name</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">string</span></span>,
                <span class="parameter-modifier">
                <em>optional</em>)
                </span>
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Task name. If <code>name</code> is nil, then return map of <code>name</code>:<code>stats</code>, else
     return map with stats.
</p>
        </span>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

         Response of the following structure:
<p><pre> {
     checked_count = number,
     expired_count = number,
     restarts = number,
     working_time = number,
 }</pre>
<p>
 where:
<p> <code>checked_count</code> is a number of tuples checked for expiration (expired + skipped).
<p> <code>expired_count</code> is a number of expired tuples.
<p> <code>restarts</code> is a number of restarts since start. From the start
 <code>restarts</code> is equal to 1.
<p> <code>working_time</code> is a task's operation time.

    </ol>




</dd>
    <dt>
    <a name="task"></a>
    <strong>task (name)</strong>
    </dt>
    <dd>
    <p>Get task by name. <table class="markdown_table">
</table>
</p>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">name</span>
            <span class="parameter-info">
                (<span class="types"><span class="type">string</span></span>)
            </span>
        <br>
        <span class="parameter-description">
        <p>
     Task name.
</p>
        </span>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        task instance
    </ol>




</dd>
    <dt>
    <a name="update"></a>
    <strong>update ()</strong>
    </dt>
    <dd>
    <p>Reload module. <table class="markdown_table">
</table>
<p>
 Update expirationd version in a running Tarantool and restart all tasks.
 Reload process step by step: remove expirationd module from
 <code>package.loaded</code>, import new version of expirationd using <code>require</code> and
 finally restart all tasks.
</p>



    <h3>Returns:</h3>
    <ol>

        None
    </ol>




</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
</div> <!-- id="container" -->
</body>
</html>
